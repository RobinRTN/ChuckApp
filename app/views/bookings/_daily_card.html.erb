<%= turbo_frame_tag "daily-card-#{weekly_index}-#{daily_index}" do %>
  <% pattern = "%H:%M"  %>
  <% unless daily_datetimes.nil?  %>
    <div class="daily-dispo-card-user mb-3">
      <p class="date-text"><%= l(daily_datetimes.first, format: "%A %e %B").capitalize %></p>

      <div class="available-block" >
          <div class="dispo-slots">
            <% daily_datetimes.each do |datetime| %>
              <% if datetime > Time.zone.now %>
                <div class="dispo-slot-container" id="dispo-slot-container-<%= daily_index %>-<%= datetime.to_i %>">
                  <%= link_to datetime.strftime(pattern), new_booking_path(datetime), class: "disponibilites-btn" %>
                  <%= link_to('<i class="fa-sharp fa-solid fa-circle-xmark"></i>'.html_safe, disponibilites_path(cancelled_slot: datetime, weekly_index: weekly_index, daily_index: daily_index), method: :get, class: "cancel-icon", onclick: "return confirm('Êtes vous sûr de vouloir supprimer cette disponibilité ?');") %>
                </div>


              <%end%>
            <%end%>
            <div class="add-slot">
              <a href="#" data-bs-toggle="modal" data-bs-target="#addSlotModal-<%=weekly_index %>-<%=daily_index %>">
                <i class="fa-solid fa-plus"></i>
              </a>
            </div>

            <div class="modal fade" id="addSlotModal-<%=weekly_index %>-<%=daily_index %>" tabindex="-1" aria-labelledby="addSlotModal-<%=weekly_index %>-<%=daily_index %>" aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                  </div>
                  <div class="modal-body">
                    <%= simple_form_for :added_slot, url: disponibilites_path, method: :get, id: "add-slot-form-#{weekly_index}-#{daily_index}", html: { class: 'form-horizontal' } do |f| %>
                      <p>Choisissez un horraire</p>
                      <%= f.input :added_slot, collection: (0..23).map { |hour| sprintf('%02d', hour) + "h00" }, input_html: { class: "form-select", data: { controller: "select2" }, style: "width: 100%;" }, label: false %>
                      <%= f.input :day, as: :hidden, input_html: { value: daily_datetimes.first } %>
                      <%= f.input :weekly_index, as: :hidden, input_html: { value: weekly_index} %>
                      <%= f.input :daily_index, as: :hidden, input_html: { value: daily_index } %>
                      <%= f.button :submit, "Add Slot", class: "btn btn-primary mt-3" %>
                    <% end %>
                  </div>
                </div>
              </div>
            </div>


          </div>
      </div>
    </div>
  <%end %>
<% end %>
